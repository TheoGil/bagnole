var $s=Object.defineProperty;var Ds=(h,e,s)=>e in h?$s(h,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):h[e]=s;var G=(h,e,s)=>Ds(h,typeof e!="symbol"?e+"":e,s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();const Os=`<svg
   version="1.1"
   width="1000"
   height="1000"
   viewBox="0 0 1000 1000"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
    <path
       style="fill:none;stroke:#f90000;stroke-width:3.77953;stroke-dasharray:none;stroke-opacity:1"
       d="m 916.76719,544.02895 -2.41255,-69.96381 c 1.99265,-55.91747 -38.67019,-88.56831 -89.26417,-115.80217 L 323.28106,103.73945 C 163.48643,20.172044 100.41388,78.313715 78.40772,196.62244 L 77.201448,607.9614 C 74.12643,734.10782 134.5654,735.53586 219.54162,688.78166 l 177.32207,-88.0579 c 77.26281,-42.40363 138.21147,-35.86479 173.70326,47.04464 l 74.7889,150.78407 c 61.68706,112.14111 154.67601,142.14666 225.64805,69.51664 22.83107,-23.36443 35.52639,-52.71488 43.35074,-110.52991 z"/>
</svg>
`;/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Fe="176",Ot=2e3,ke=2001,Y=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Le=1234567;const Ie=Math.PI/180,Je=180/Math.PI;function Ns(){const h=Math.random()*4294967295|0,e=Math.random()*4294967295|0,s=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Y[h&255]+Y[h>>8&255]+Y[h>>16&255]+Y[h>>24&255]+"-"+Y[e&255]+Y[e>>8&255]+"-"+Y[e>>16&15|64]+Y[e>>24&255]+"-"+Y[s&63|128]+Y[s>>8&255]+"-"+Y[s>>16&255]+Y[s>>24&255]+Y[n&255]+Y[n>>8&255]+Y[n>>16&255]+Y[n>>24&255]).toLowerCase()}function U(h,e,s){return Math.max(e,Math.min(s,h))}function Ue(h,e){return(h%e+e)%e}function qs(h,e,s,n,r){return n+(h-e)*(r-n)/(s-e)}function Vs(h,e,s){return h!==e?(s-h)/(e-h):0}function Xe(h,e,s){return(1-s)*h+s*e}function Fs(h,e,s,n){return Xe(h,e,1-Math.exp(-s*n))}function Is(h,e=1){return e-Math.abs(Ue(h,e*2)-e)}function Js(h,e,s){return h<=e?0:h>=s?1:(h=(h-e)/(s-e),h*h*(3-2*h))}function Us(h,e,s){return h<=e?0:h>=s?1:(h=(h-e)/(s-e),h*h*h*(h*(h*6-15)+10))}function Xs(h,e){return h+Math.floor(Math.random()*(e-h+1))}function Ys(h,e){return h+Math.random()*(e-h)}function Zs(h){return h*(.5-Math.random())}function Qs(h){h!==void 0&&(Le=h);let e=Le+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Hs(h){return h*Ie}function Ws(h){return h*Je}function Gs(h){return(h&h-1)===0&&h!==0}function Bs(h){return Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))}function Ks(h){return Math.pow(2,Math.floor(Math.log(h)/Math.LN2))}function js(h,e,s,n,r){const i=Math.cos,o=Math.sin,a=i(s/2),u=o(s/2),f=i((e+n)/2),p=o((e+n)/2),x=i((e-n)/2),v=o((e-n)/2),m=i((n-e)/2),z=o((n-e)/2);switch(r){case"XYX":h.set(a*p,u*x,u*v,a*f);break;case"YZY":h.set(u*v,a*p,u*x,a*f);break;case"ZXZ":h.set(u*x,u*v,a*p,a*f);break;case"XZX":h.set(a*p,u*z,u*m,a*f);break;case"YXY":h.set(u*m,a*p,u*z,a*f);break;case"ZYZ":h.set(u*z,u*m,a*p,a*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ti(h,e){switch(e.constructor){case Float32Array:return h;case Uint32Array:return h/4294967295;case Uint16Array:return h/65535;case Uint8Array:return h/255;case Int32Array:return Math.max(h/2147483647,-1);case Int16Array:return Math.max(h/32767,-1);case Int8Array:return Math.max(h/127,-1);default:throw new Error("Invalid component type.")}}function ei(h,e){switch(e.constructor){case Float32Array:return h;case Uint32Array:return Math.round(h*4294967295);case Uint16Array:return Math.round(h*65535);case Uint8Array:return Math.round(h*255);case Int32Array:return Math.round(h*2147483647);case Int16Array:return Math.round(h*32767);case Int8Array:return Math.round(h*127);default:throw new Error("Invalid component type.")}}const jt={DEG2RAD:Ie,RAD2DEG:Je,generateUUID:Ns,clamp:U,euclideanModulo:Ue,mapLinear:qs,inverseLerp:Vs,lerp:Xe,damp:Fs,pingpong:Is,smoothstep:Js,smootherstep:Us,randInt:Xs,randFloat:Ys,randFloatSpread:Zs,seededRandom:Qs,degToRad:Hs,radToDeg:Ws,isPowerOfTwo:Gs,ceilPowerOfTwo:Bs,floorPowerOfTwo:Ks,setQuaternionFromProperEuler:js,normalize:ei,denormalize:ti};class ${constructor(e=0,s=0){$.prototype.isVector2=!0,this.x=e,this.y=s}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,s){return this.x=e,this.y=s,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,s){switch(e){case 0:this.x=s;break;case 1:this.y=s;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,s){return this.x=e.x+s.x,this.y=e.y+s.y,this}addScaledVector(e,s){return this.x+=e.x*s,this.y+=e.y*s,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,s){return this.x=e.x-s.x,this.y=e.y-s.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const s=this.x,n=this.y,r=e.elements;return this.x=r[0]*s+r[3]*n+r[6],this.y=r[1]*s+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,s){return this.x=U(this.x,e.x,s.x),this.y=U(this.y,e.y,s.y),this}clampScalar(e,s){return this.x=U(this.x,e,s),this.y=U(this.y,e,s),this}clampLength(e,s){const n=this.length();return this.divideScalar(n||1).multiplyScalar(U(n,e,s))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const s=Math.sqrt(this.lengthSq()*e.lengthSq());if(s===0)return Math.PI/2;const n=this.dot(e)/s;return Math.acos(U(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const s=this.x-e.x,n=this.y-e.y;return s*s+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,s){return this.x+=(e.x-this.x)*s,this.y+=(e.y-this.y)*s,this}lerpVectors(e,s,n){return this.x=e.x+(s.x-e.x)*n,this.y=e.y+(s.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,s=0){return this.x=e[s],this.y=e[s+1],this}toArray(e=[],s=0){return e[s]=this.x,e[s+1]=this.y,e}fromBufferAttribute(e,s){return this.x=e.getX(s),this.y=e.getY(s),this}rotateAround(e,s){const n=Math.cos(s),r=Math.sin(s),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class si{constructor(e=0,s=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=s,this._z=n,this._w=r}static slerpFlat(e,s,n,r,i,o,a){let u=n[r+0],f=n[r+1],p=n[r+2],x=n[r+3];const v=i[o+0],m=i[o+1],z=i[o+2],_=i[o+3];if(a===0){e[s+0]=u,e[s+1]=f,e[s+2]=p,e[s+3]=x;return}if(a===1){e[s+0]=v,e[s+1]=m,e[s+2]=z,e[s+3]=_;return}if(x!==_||u!==v||f!==m||p!==z){let S=1-a;const C=u*v+f*m+p*z+x*_,T=C>=0?1:-1,P=1-C*C;if(P>Number.EPSILON){const b=Math.sqrt(P),R=Math.atan2(b,C*T);S=Math.sin(S*R)/b,a=Math.sin(a*R)/b}const O=a*T;if(u=u*S+v*O,f=f*S+m*O,p=p*S+z*O,x=x*S+_*O,S===1-a){const b=1/Math.sqrt(u*u+f*f+p*p+x*x);u*=b,f*=b,p*=b,x*=b}}e[s]=u,e[s+1]=f,e[s+2]=p,e[s+3]=x}static multiplyQuaternionsFlat(e,s,n,r,i,o){const a=n[r],u=n[r+1],f=n[r+2],p=n[r+3],x=i[o],v=i[o+1],m=i[o+2],z=i[o+3];return e[s]=a*z+p*x+u*m-f*v,e[s+1]=u*z+p*v+f*x-a*m,e[s+2]=f*z+p*m+a*v-u*x,e[s+3]=p*z-a*x-u*v-f*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,s,n,r){return this._x=e,this._y=s,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,s=!0){const n=e._x,r=e._y,i=e._z,o=e._order,a=Math.cos,u=Math.sin,f=a(n/2),p=a(r/2),x=a(i/2),v=u(n/2),m=u(r/2),z=u(i/2);switch(o){case"XYZ":this._x=v*p*x+f*m*z,this._y=f*m*x-v*p*z,this._z=f*p*z+v*m*x,this._w=f*p*x-v*m*z;break;case"YXZ":this._x=v*p*x+f*m*z,this._y=f*m*x-v*p*z,this._z=f*p*z-v*m*x,this._w=f*p*x+v*m*z;break;case"ZXY":this._x=v*p*x-f*m*z,this._y=f*m*x+v*p*z,this._z=f*p*z+v*m*x,this._w=f*p*x-v*m*z;break;case"ZYX":this._x=v*p*x-f*m*z,this._y=f*m*x+v*p*z,this._z=f*p*z-v*m*x,this._w=f*p*x+v*m*z;break;case"YZX":this._x=v*p*x+f*m*z,this._y=f*m*x+v*p*z,this._z=f*p*z-v*m*x,this._w=f*p*x-v*m*z;break;case"XZY":this._x=v*p*x-f*m*z,this._y=f*m*x-v*p*z,this._z=f*p*z+v*m*x,this._w=f*p*x+v*m*z;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return s===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,s){const n=s/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const s=e.elements,n=s[0],r=s[4],i=s[8],o=s[1],a=s[5],u=s[9],f=s[2],p=s[6],x=s[10],v=n+a+x;if(v>0){const m=.5/Math.sqrt(v+1);this._w=.25/m,this._x=(p-u)*m,this._y=(i-f)*m,this._z=(o-r)*m}else if(n>a&&n>x){const m=2*Math.sqrt(1+n-a-x);this._w=(p-u)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(i+f)/m}else if(a>x){const m=2*Math.sqrt(1+a-n-x);this._w=(i-f)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(u+p)/m}else{const m=2*Math.sqrt(1+x-n-a);this._w=(o-r)/m,this._x=(i+f)/m,this._y=(u+p)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,s){let n=e.dot(s)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*s.z-e.z*s.y,this._y=e.z*s.x-e.x*s.z,this._z=e.x*s.y-e.y*s.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(U(this.dot(e),-1,1)))}rotateTowards(e,s){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,s/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,s){const n=e._x,r=e._y,i=e._z,o=e._w,a=s._x,u=s._y,f=s._z,p=s._w;return this._x=n*p+o*a+r*f-i*u,this._y=r*p+o*u+i*a-n*f,this._z=i*p+o*f+n*u-r*a,this._w=o*p-n*a-r*u-i*f,this._onChangeCallback(),this}slerp(e,s){if(s===0)return this;if(s===1)return this.copy(e);const n=this._x,r=this._y,i=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const u=1-a*a;if(u<=Number.EPSILON){const m=1-s;return this._w=m*o+s*this._w,this._x=m*n+s*this._x,this._y=m*r+s*this._y,this._z=m*i+s*this._z,this.normalize(),this}const f=Math.sqrt(u),p=Math.atan2(f,a),x=Math.sin((1-s)*p)/f,v=Math.sin(s*p)/f;return this._w=o*x+this._w*v,this._x=n*x+this._x*v,this._y=r*x+this._y*v,this._z=i*x+this._z*v,this._onChangeCallback(),this}slerpQuaternions(e,s,n){return this.copy(e).slerp(s,n)}random(){const e=2*Math.PI*Math.random(),s=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(s),i*Math.cos(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,s=0){return this._x=e[s],this._y=e[s+1],this._z=e[s+2],this._w=e[s+3],this._onChangeCallback(),this}toArray(e=[],s=0){return e[s]=this._x,e[s+1]=this._y,e[s+2]=this._z,e[s+3]=this._w,e}fromBufferAttribute(e,s){return this._x=e.getX(s),this._y=e.getY(s),this._z=e.getZ(s),this._w=e.getW(s),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class D{constructor(e=0,s=0,n=0){D.prototype.isVector3=!0,this.x=e,this.y=s,this.z=n}set(e,s,n){return n===void 0&&(n=this.z),this.x=e,this.y=s,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,s){switch(e){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,s){return this.x=e.x+s.x,this.y=e.y+s.y,this.z=e.z+s.z,this}addScaledVector(e,s){return this.x+=e.x*s,this.y+=e.y*s,this.z+=e.z*s,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,s){return this.x=e.x-s.x,this.y=e.y-s.y,this.z=e.z-s.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,s){return this.x=e.x*s.x,this.y=e.y*s.y,this.z=e.z*s.z,this}applyEuler(e){return this.applyQuaternion(Pe.setFromEuler(e))}applyAxisAngle(e,s){return this.applyQuaternion(Pe.setFromAxisAngle(e,s))}applyMatrix3(e){const s=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*s+i[3]*n+i[6]*r,this.y=i[1]*s+i[4]*n+i[7]*r,this.z=i[2]*s+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const s=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*s+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*s+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*s+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*s+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(e){const s=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,u=e.w,f=2*(o*r-a*n),p=2*(a*s-i*r),x=2*(i*n-o*s);return this.x=s+u*f+o*x-a*p,this.y=n+u*p+a*f-i*x,this.z=r+u*x+i*p-o*f,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const s=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*s+i[4]*n+i[8]*r,this.y=i[1]*s+i[5]*n+i[9]*r,this.z=i[2]*s+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,s){return this.x=U(this.x,e.x,s.x),this.y=U(this.y,e.y,s.y),this.z=U(this.z,e.z,s.z),this}clampScalar(e,s){return this.x=U(this.x,e,s),this.y=U(this.y,e,s),this.z=U(this.z,e,s),this}clampLength(e,s){const n=this.length();return this.divideScalar(n||1).multiplyScalar(U(n,e,s))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,s){return this.x+=(e.x-this.x)*s,this.y+=(e.y-this.y)*s,this.z+=(e.z-this.z)*s,this}lerpVectors(e,s,n){return this.x=e.x+(s.x-e.x)*n,this.y=e.y+(s.y-e.y)*n,this.z=e.z+(s.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,s){const n=e.x,r=e.y,i=e.z,o=s.x,a=s.y,u=s.z;return this.x=r*u-i*a,this.y=i*o-n*u,this.z=n*a-r*o,this}projectOnVector(e){const s=e.lengthSq();if(s===0)return this.set(0,0,0);const n=e.dot(this)/s;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return te.copy(this).projectOnVector(e),this.sub(te)}reflect(e){return this.sub(te.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const s=Math.sqrt(this.lengthSq()*e.lengthSq());if(s===0)return Math.PI/2;const n=this.dot(e)/s;return Math.acos(U(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const s=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return s*s+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,s,n){const r=Math.sin(s)*e;return this.x=r*Math.sin(n),this.y=Math.cos(s)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,s,n){return this.x=e*Math.sin(s),this.y=n,this.z=e*Math.cos(s),this}setFromMatrixPosition(e){const s=e.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}setFromMatrixScale(e){const s=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=s,this.y=n,this.z=r,this}setFromMatrixColumn(e,s){return this.fromArray(e.elements,s*4)}setFromMatrix3Column(e,s){return this.fromArray(e.elements,s*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,s=0){return this.x=e[s],this.y=e[s+1],this.z=e[s+2],this}toArray(e=[],s=0){return e[s]=this.x,e[s+1]=this.y,e[s+2]=this.z,e}fromBufferAttribute(e,s){return this.x=e.getX(s),this.y=e.getY(s),this.z=e.getZ(s),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,s=Math.random()*2-1,n=Math.sqrt(1-s*s);return this.x=n*Math.cos(e),this.y=s,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const te=new D,Pe=new si;class Lt{constructor(e,s,n,r,i,o,a,u,f,p,x,v,m,z,_,S){Lt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,s,n,r,i,o,a,u,f,p,x,v,m,z,_,S)}set(e,s,n,r,i,o,a,u,f,p,x,v,m,z,_,S){const C=this.elements;return C[0]=e,C[4]=s,C[8]=n,C[12]=r,C[1]=i,C[5]=o,C[9]=a,C[13]=u,C[2]=f,C[6]=p,C[10]=x,C[14]=v,C[3]=m,C[7]=z,C[11]=_,C[15]=S,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Lt().fromArray(this.elements)}copy(e){const s=this.elements,n=e.elements;return s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],this}copyPosition(e){const s=this.elements,n=e.elements;return s[12]=n[12],s[13]=n[13],s[14]=n[14],this}setFromMatrix3(e){const s=e.elements;return this.set(s[0],s[3],s[6],0,s[1],s[4],s[7],0,s[2],s[5],s[8],0,0,0,0,1),this}extractBasis(e,s,n){return e.setFromMatrixColumn(this,0),s.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,s,n){return this.set(e.x,s.x,n.x,0,e.y,s.y,n.y,0,e.z,s.z,n.z,0,0,0,0,1),this}extractRotation(e){const s=this.elements,n=e.elements,r=1/mt.setFromMatrixColumn(e,0).length(),i=1/mt.setFromMatrixColumn(e,1).length(),o=1/mt.setFromMatrixColumn(e,2).length();return s[0]=n[0]*r,s[1]=n[1]*r,s[2]=n[2]*r,s[3]=0,s[4]=n[4]*i,s[5]=n[5]*i,s[6]=n[6]*i,s[7]=0,s[8]=n[8]*o,s[9]=n[9]*o,s[10]=n[10]*o,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromEuler(e){const s=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),a=Math.sin(n),u=Math.cos(r),f=Math.sin(r),p=Math.cos(i),x=Math.sin(i);if(e.order==="XYZ"){const v=o*p,m=o*x,z=a*p,_=a*x;s[0]=u*p,s[4]=-u*x,s[8]=f,s[1]=m+z*f,s[5]=v-_*f,s[9]=-a*u,s[2]=_-v*f,s[6]=z+m*f,s[10]=o*u}else if(e.order==="YXZ"){const v=u*p,m=u*x,z=f*p,_=f*x;s[0]=v+_*a,s[4]=z*a-m,s[8]=o*f,s[1]=o*x,s[5]=o*p,s[9]=-a,s[2]=m*a-z,s[6]=_+v*a,s[10]=o*u}else if(e.order==="ZXY"){const v=u*p,m=u*x,z=f*p,_=f*x;s[0]=v-_*a,s[4]=-o*x,s[8]=z+m*a,s[1]=m+z*a,s[5]=o*p,s[9]=_-v*a,s[2]=-o*f,s[6]=a,s[10]=o*u}else if(e.order==="ZYX"){const v=o*p,m=o*x,z=a*p,_=a*x;s[0]=u*p,s[4]=z*f-m,s[8]=v*f+_,s[1]=u*x,s[5]=_*f+v,s[9]=m*f-z,s[2]=-f,s[6]=a*u,s[10]=o*u}else if(e.order==="YZX"){const v=o*u,m=o*f,z=a*u,_=a*f;s[0]=u*p,s[4]=_-v*x,s[8]=z*x+m,s[1]=x,s[5]=o*p,s[9]=-a*p,s[2]=-f*p,s[6]=m*x+z,s[10]=v-_*x}else if(e.order==="XZY"){const v=o*u,m=o*f,z=a*u,_=a*f;s[0]=u*p,s[4]=-x,s[8]=f*p,s[1]=v*x+_,s[5]=o*p,s[9]=m*x-z,s[2]=z*x-m,s[6]=a*p,s[10]=_*x+v}return s[3]=0,s[7]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ii,e,ni)}lookAt(e,s,n){const r=this.elements;return B.subVectors(e,s),B.lengthSq()===0&&(B.z=1),B.normalize(),nt.crossVectors(n,B),nt.lengthSq()===0&&(Math.abs(n.z)===1?B.x+=1e-4:B.z+=1e-4,B.normalize(),nt.crossVectors(n,B)),nt.normalize(),Nt.crossVectors(B,nt),r[0]=nt.x,r[4]=Nt.x,r[8]=B.x,r[1]=nt.y,r[5]=Nt.y,r[9]=B.y,r[2]=nt.z,r[6]=Nt.z,r[10]=B.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,s){const n=e.elements,r=s.elements,i=this.elements,o=n[0],a=n[4],u=n[8],f=n[12],p=n[1],x=n[5],v=n[9],m=n[13],z=n[2],_=n[6],S=n[10],C=n[14],T=n[3],P=n[7],O=n[11],b=n[15],R=r[0],E=r[4],k=r[8],F=r[12],N=r[1],X=r[5],J=r[9],Z=r[13],W=r[2],it=r[6],at=r[10],ct=r[14],lt=r[3],ut=r[7],ft=r[11],yt=r[15];return i[0]=o*R+a*N+u*W+f*lt,i[4]=o*E+a*X+u*it+f*ut,i[8]=o*k+a*J+u*at+f*ft,i[12]=o*F+a*Z+u*ct+f*yt,i[1]=p*R+x*N+v*W+m*lt,i[5]=p*E+x*X+v*it+m*ut,i[9]=p*k+x*J+v*at+m*ft,i[13]=p*F+x*Z+v*ct+m*yt,i[2]=z*R+_*N+S*W+C*lt,i[6]=z*E+_*X+S*it+C*ut,i[10]=z*k+_*J+S*at+C*ft,i[14]=z*F+_*Z+S*ct+C*yt,i[3]=T*R+P*N+O*W+b*lt,i[7]=T*E+P*X+O*it+b*ut,i[11]=T*k+P*J+O*at+b*ft,i[15]=T*F+P*Z+O*ct+b*yt,this}multiplyScalar(e){const s=this.elements;return s[0]*=e,s[4]*=e,s[8]*=e,s[12]*=e,s[1]*=e,s[5]*=e,s[9]*=e,s[13]*=e,s[2]*=e,s[6]*=e,s[10]*=e,s[14]*=e,s[3]*=e,s[7]*=e,s[11]*=e,s[15]*=e,this}determinant(){const e=this.elements,s=e[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],u=e[9],f=e[13],p=e[2],x=e[6],v=e[10],m=e[14],z=e[3],_=e[7],S=e[11],C=e[15];return z*(+i*u*x-r*f*x-i*a*v+n*f*v+r*a*m-n*u*m)+_*(+s*u*m-s*f*v+i*o*v-r*o*m+r*f*p-i*u*p)+S*(+s*f*x-s*a*m-i*o*x+n*o*m+i*a*p-n*f*p)+C*(-r*a*p-s*u*x+s*a*v+r*o*x-n*o*v+n*u*p)}transpose(){const e=this.elements;let s;return s=e[1],e[1]=e[4],e[4]=s,s=e[2],e[2]=e[8],e[8]=s,s=e[6],e[6]=e[9],e[9]=s,s=e[3],e[3]=e[12],e[12]=s,s=e[7],e[7]=e[13],e[13]=s,s=e[11],e[11]=e[14],e[14]=s,this}setPosition(e,s,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=s,r[14]=n),this}invert(){const e=this.elements,s=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],u=e[6],f=e[7],p=e[8],x=e[9],v=e[10],m=e[11],z=e[12],_=e[13],S=e[14],C=e[15],T=x*S*f-_*v*f+_*u*m-a*S*m-x*u*C+a*v*C,P=z*v*f-p*S*f-z*u*m+o*S*m+p*u*C-o*v*C,O=p*_*f-z*x*f+z*a*m-o*_*m-p*a*C+o*x*C,b=z*x*u-p*_*u-z*a*v+o*_*v+p*a*S-o*x*S,R=s*T+n*P+r*O+i*b;if(R===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/R;return e[0]=T*E,e[1]=(_*v*i-x*S*i-_*r*m+n*S*m+x*r*C-n*v*C)*E,e[2]=(a*S*i-_*u*i+_*r*f-n*S*f-a*r*C+n*u*C)*E,e[3]=(x*u*i-a*v*i-x*r*f+n*v*f+a*r*m-n*u*m)*E,e[4]=P*E,e[5]=(p*S*i-z*v*i+z*r*m-s*S*m-p*r*C+s*v*C)*E,e[6]=(z*u*i-o*S*i-z*r*f+s*S*f+o*r*C-s*u*C)*E,e[7]=(o*v*i-p*u*i+p*r*f-s*v*f-o*r*m+s*u*m)*E,e[8]=O*E,e[9]=(z*x*i-p*_*i-z*n*m+s*_*m+p*n*C-s*x*C)*E,e[10]=(o*_*i-z*a*i+z*n*f-s*_*f-o*n*C+s*a*C)*E,e[11]=(p*a*i-o*x*i-p*n*f+s*x*f+o*n*m-s*a*m)*E,e[12]=b*E,e[13]=(p*_*r-z*x*r+z*n*v-s*_*v-p*n*S+s*x*S)*E,e[14]=(z*a*r-o*_*r-z*n*u+s*_*u+o*n*S-s*a*S)*E,e[15]=(o*x*r-p*a*r+p*n*u-s*x*u-o*n*v+s*a*v)*E,this}scale(e){const s=this.elements,n=e.x,r=e.y,i=e.z;return s[0]*=n,s[4]*=r,s[8]*=i,s[1]*=n,s[5]*=r,s[9]*=i,s[2]*=n,s[6]*=r,s[10]*=i,s[3]*=n,s[7]*=r,s[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,s=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(s,n,r))}makeTranslation(e,s,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,s,0,0,1,n,0,0,0,1),this}makeRotationX(e){const s=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,s,-n,0,0,n,s,0,0,0,0,1),this}makeRotationY(e){const s=Math.cos(e),n=Math.sin(e);return this.set(s,0,n,0,0,1,0,0,-n,0,s,0,0,0,0,1),this}makeRotationZ(e){const s=Math.cos(e),n=Math.sin(e);return this.set(s,-n,0,0,n,s,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,s){const n=Math.cos(s),r=Math.sin(s),i=1-n,o=e.x,a=e.y,u=e.z,f=i*o,p=i*a;return this.set(f*o+n,f*a-r*u,f*u+r*a,0,f*a+r*u,p*a+n,p*u-r*o,0,f*u-r*a,p*u+r*o,i*u*u+n,0,0,0,0,1),this}makeScale(e,s,n){return this.set(e,0,0,0,0,s,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,s,n,r,i,o){return this.set(1,n,i,0,e,1,o,0,s,r,1,0,0,0,0,1),this}compose(e,s,n){const r=this.elements,i=s._x,o=s._y,a=s._z,u=s._w,f=i+i,p=o+o,x=a+a,v=i*f,m=i*p,z=i*x,_=o*p,S=o*x,C=a*x,T=u*f,P=u*p,O=u*x,b=n.x,R=n.y,E=n.z;return r[0]=(1-(_+C))*b,r[1]=(m+O)*b,r[2]=(z-P)*b,r[3]=0,r[4]=(m-O)*R,r[5]=(1-(v+C))*R,r[6]=(S+T)*R,r[7]=0,r[8]=(z+P)*E,r[9]=(S-T)*E,r[10]=(1-(v+_))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,s,n){const r=this.elements;let i=mt.set(r[0],r[1],r[2]).length();const o=mt.set(r[4],r[5],r[6]).length(),a=mt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],j.copy(this);const f=1/i,p=1/o,x=1/a;return j.elements[0]*=f,j.elements[1]*=f,j.elements[2]*=f,j.elements[4]*=p,j.elements[5]*=p,j.elements[6]*=p,j.elements[8]*=x,j.elements[9]*=x,j.elements[10]*=x,s.setFromRotationMatrix(j),n.x=i,n.y=o,n.z=a,this}makePerspective(e,s,n,r,i,o,a=Ot){const u=this.elements,f=2*i/(s-e),p=2*i/(n-r),x=(s+e)/(s-e),v=(n+r)/(n-r);let m,z;if(a===Ot)m=-(o+i)/(o-i),z=-2*o*i/(o-i);else if(a===ke)m=-o/(o-i),z=-o*i/(o-i);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return u[0]=f,u[4]=0,u[8]=x,u[12]=0,u[1]=0,u[5]=p,u[9]=v,u[13]=0,u[2]=0,u[6]=0,u[10]=m,u[14]=z,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,s,n,r,i,o,a=Ot){const u=this.elements,f=1/(s-e),p=1/(n-r),x=1/(o-i),v=(s+e)*f,m=(n+r)*p;let z,_;if(a===Ot)z=(o+i)*x,_=-2*x;else if(a===ke)z=i*x,_=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return u[0]=2*f,u[4]=0,u[8]=0,u[12]=-v,u[1]=0,u[5]=2*p,u[9]=0,u[13]=-m,u[2]=0,u[6]=0,u[10]=_,u[14]=-z,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){const s=this.elements,n=e.elements;for(let r=0;r<16;r++)if(s[r]!==n[r])return!1;return!0}fromArray(e,s=0){for(let n=0;n<16;n++)this.elements[n]=e[n+s];return this}toArray(e=[],s=0){const n=this.elements;return e[s]=n[0],e[s+1]=n[1],e[s+2]=n[2],e[s+3]=n[3],e[s+4]=n[4],e[s+5]=n[5],e[s+6]=n[6],e[s+7]=n[7],e[s+8]=n[8],e[s+9]=n[9],e[s+10]=n[10],e[s+11]=n[11],e[s+12]=n[12],e[s+13]=n[13],e[s+14]=n[14],e[s+15]=n[15],e}}const mt=new D,j=new Lt,ii=new D(0,0,0),ni=new D(1,1,1),nt=new D,Nt=new D,B=new D;class et{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,s){const n=this.getUtoTmapping(e);return this.getPoint(n,s)}getPoints(e=5){const s=[];for(let n=0;n<=e;n++)s.push(this.getPoint(n/e));return s}getSpacedPoints(e=5){const s=[];for(let n=0;n<=e;n++)s.push(this.getPointAt(n/e));return s}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const s=[];let n,r=this.getPoint(0),i=0;s.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),i+=n.distanceTo(r),s.push(i),r=n;return this.cacheArcLengths=s,s}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,s=null){const n=this.getLengths();let r=0;const i=n.length;let o;s?o=s:o=e*n[i-1];let a=0,u=i-1,f;for(;a<=u;)if(r=Math.floor(a+(u-a)/2),f=n[r]-o,f<0)a=r+1;else if(f>0)u=r-1;else{u=r;break}if(r=u,n[r]===o)return r/(i-1);const p=n[r],v=n[r+1]-p,m=(o-p)/v;return(r+m)/(i-1)}getTangent(e,s){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);const o=this.getPoint(r),a=this.getPoint(i),u=s||(o.isVector2?new $:new D);return u.copy(a).sub(o).normalize(),u}getTangentAt(e,s){const n=this.getUtoTmapping(e);return this.getTangent(n,s)}computeFrenetFrames(e,s=!1){const n=new D,r=[],i=[],o=[],a=new D,u=new Lt;for(let m=0;m<=e;m++){const z=m/e;r[m]=this.getTangentAt(z,new D)}i[0]=new D,o[0]=new D;let f=Number.MAX_VALUE;const p=Math.abs(r[0].x),x=Math.abs(r[0].y),v=Math.abs(r[0].z);p<=f&&(f=p,n.set(1,0,0)),x<=f&&(f=x,n.set(0,1,0)),v<=f&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],a),o[0].crossVectors(r[0],i[0]);for(let m=1;m<=e;m++){if(i[m]=i[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(r[m-1],r[m]),a.length()>Number.EPSILON){a.normalize();const z=Math.acos(U(r[m-1].dot(r[m]),-1,1));i[m].applyMatrix4(u.makeRotationAxis(a,z))}o[m].crossVectors(r[m],i[m])}if(s===!0){let m=Math.acos(U(i[0].dot(i[e]),-1,1));m/=e,r[0].dot(a.crossVectors(i[0],i[e]))>0&&(m=-m);for(let z=1;z<=e;z++)i[z].applyMatrix4(u.makeRotationAxis(r[z],m*z)),o[z].crossVectors(r[z],i[z])}return{tangents:r,normals:i,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ye extends et{constructor(e=0,s=0,n=1,r=1,i=0,o=Math.PI*2,a=!1,u=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=s,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=a,this.aRotation=u}getPoint(e,s=new $){const n=s,r=Math.PI*2;let i=this.aEndAngle-this.aStartAngle;const o=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(o?i=0:i=r),this.aClockwise===!0&&!o&&(i===r?i=-r:i=i-r);const a=this.aStartAngle+e*i;let u=this.aX+this.xRadius*Math.cos(a),f=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const p=Math.cos(this.aRotation),x=Math.sin(this.aRotation),v=u-this.aX,m=f-this.aY;u=v*p-m*x+this.aX,f=v*x+m*p+this.aY}return n.set(u,f)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class ri extends Ye{constructor(e,s,n,r,i,o){super(e,s,n,n,r,i,o),this.isArcCurve=!0,this.type="ArcCurve"}}function le(){let h=0,e=0,s=0,n=0;function r(i,o,a,u){h=i,e=a,s=-3*i+3*o-2*a-u,n=2*i-2*o+a+u}return{initCatmullRom:function(i,o,a,u,f){r(o,a,f*(a-i),f*(u-o))},initNonuniformCatmullRom:function(i,o,a,u,f,p,x){let v=(o-i)/f-(a-i)/(f+p)+(a-o)/p,m=(a-o)/p-(u-o)/(p+x)+(u-a)/x;v*=p,m*=p,r(o,a,v,m)},calc:function(i){const o=i*i,a=o*i;return h+e*i+s*o+n*a}}}const qt=new D,ee=new le,se=new le,ie=new le;class oi extends et{constructor(e=[],s=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=s,this.curveType=n,this.tension=r}getPoint(e,s=new D){const n=s,r=this.points,i=r.length,o=(i-(this.closed?0:1))*e;let a=Math.floor(o),u=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/i)+1)*i:u===0&&a===i-1&&(a=i-2,u=1);let f,p;this.closed||a>0?f=r[(a-1)%i]:(qt.subVectors(r[0],r[1]).add(r[0]),f=qt);const x=r[a%i],v=r[(a+1)%i];if(this.closed||a+2<i?p=r[(a+2)%i]:(qt.subVectors(r[i-1],r[i-2]).add(r[i-1]),p=qt),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let z=Math.pow(f.distanceToSquared(x),m),_=Math.pow(x.distanceToSquared(v),m),S=Math.pow(v.distanceToSquared(p),m);_<1e-4&&(_=1),z<1e-4&&(z=_),S<1e-4&&(S=_),ee.initNonuniformCatmullRom(f.x,x.x,v.x,p.x,z,_,S),se.initNonuniformCatmullRom(f.y,x.y,v.y,p.y,z,_,S),ie.initNonuniformCatmullRom(f.z,x.z,v.z,p.z,z,_,S)}else this.curveType==="catmullrom"&&(ee.initCatmullRom(f.x,x.x,v.x,p.x,this.tension),se.initCatmullRom(f.y,x.y,v.y,p.y,this.tension),ie.initCatmullRom(f.z,x.z,v.z,p.z,this.tension));return n.set(ee.calc(u),se.calc(u),ie.calc(u)),n}copy(e){super.copy(e),this.points=[];for(let s=0,n=e.points.length;s<n;s++){const r=e.points[s];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let s=0,n=this.points.length;s<n;s++){const r=this.points[s];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let s=0,n=e.points.length;s<n;s++){const r=e.points[s];this.points.push(new D().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Re(h,e,s,n,r){const i=(n-e)*.5,o=(r-s)*.5,a=h*h,u=h*a;return(2*s-2*n+i+o)*u+(-3*s+3*n-2*i-o)*a+i*h+s}function hi(h,e){const s=1-h;return s*s*e}function ai(h,e){return 2*(1-h)*h*e}function ci(h,e){return h*h*e}function bt(h,e,s,n){return hi(h,e)+ai(h,s)+ci(h,n)}function li(h,e){const s=1-h;return s*s*s*e}function ui(h,e){const s=1-h;return 3*s*s*h*e}function fi(h,e){return 3*(1-h)*h*h*e}function yi(h,e){return h*h*h*e}function Et(h,e,s,n,r){return li(h,e)+ui(h,s)+fi(h,n)+yi(h,r)}class Ze extends et{constructor(e=new $,s=new $,n=new $,r=new $){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=s,this.v2=n,this.v3=r}getPoint(e,s=new $){const n=s,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Et(e,r.x,i.x,o.x,a.x),Et(e,r.y,i.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class pi extends et{constructor(e=new D,s=new D,n=new D,r=new D){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=s,this.v2=n,this.v3=r}getPoint(e,s=new D){const n=s,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Et(e,r.x,i.x,o.x,a.x),Et(e,r.y,i.y,o.y,a.y),Et(e,r.z,i.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Qe extends et{constructor(e=new $,s=new $){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=s}getPoint(e,s=new $){const n=s;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,s){return this.getPoint(e,s)}getTangent(e,s=new $){return s.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,s){return this.getTangent(e,s)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xi extends et{constructor(e=new D,s=new D){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=s}getPoint(e,s=new D){const n=s;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,s){return this.getPoint(e,s)}getTangent(e,s=new D){return s.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,s){return this.getTangent(e,s)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gi extends et{constructor(e=new $,s=new $,n=new $){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=s,this.v2=n}getPoint(e,s=new $){const n=s,r=this.v0,i=this.v1,o=this.v2;return n.set(bt(e,r.x,i.x,o.x),bt(e,r.y,i.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class mi extends et{constructor(e=new D,s=new D,n=new D){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=s,this.v2=n}getPoint(e,s=new D){const n=s,r=this.v0,i=this.v1,o=this.v2;return n.set(bt(e,r.x,i.x,o.x),bt(e,r.y,i.y,o.y),bt(e,r.z,i.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class di extends et{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,s=new $){const n=s,r=this.points,i=(r.length-1)*e,o=Math.floor(i),a=i-o,u=r[o===0?o:o-1],f=r[o],p=r[o>r.length-2?r.length-1:o+1],x=r[o>r.length-3?r.length-1:o+2];return n.set(Re(a,u.x,f.x,p.x,x.x),Re(a,u.y,f.y,p.y,x.y)),n}copy(e){super.copy(e),this.points=[];for(let s=0,n=e.points.length;s<n;s++){const r=e.points[s];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let s=0,n=this.points.length;s<n;s++){const r=this.points[s];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let s=0,n=e.points.length;s<n;s++){const r=e.points[s];this.points.push(new $().fromArray(r))}return this}}var Te=Object.freeze({__proto__:null,ArcCurve:ri,CatmullRomCurve3:oi,CubicBezierCurve:Ze,CubicBezierCurve3:pi,EllipseCurve:Ye,LineCurve:Qe,LineCurve3:xi,QuadraticBezierCurve:gi,QuadraticBezierCurve3:mi,SplineCurve:di});class vi extends et{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),s=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(s)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Te[n](s,e))}return this}getPoint(e,s){const n=e*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const o=r[i]-n,a=this.curves[i],u=a.getLength(),f=u===0?0:1-o/u;return a.getPointAt(f,s)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let s=0;for(let n=0,r=this.curves.length;n<r;n++)s+=this.curves[n].getLength(),e.push(s);return this.cacheLengths=e,e}getSpacedPoints(e=40){const s=[];for(let n=0;n<=e;n++)s.push(this.getPoint(n/e));return this.autoClose&&s.push(s[0]),s}getPoints(e=12){const s=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const o=i[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,u=o.getPoints(a);for(let f=0;f<u.length;f++){const p=u[f];n&&n.equals(p)||(s.push(p),n=p)}}return this.autoClose&&s.length>1&&!s[s.length-1].equals(s[0])&&s.push(s[0]),s}copy(e){super.copy(e),this.curves=[];for(let s=0,n=e.curves.length;s<n;s++){const r=e.curves[s];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let s=0,n=this.curves.length;s<n;s++){const r=this.curves[s];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let s=0,n=e.curves.length;s<n;s++){const r=e.curves[s];this.curves.push(new Te[r.type]().fromJSON(r))}return this}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Fe}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Fe);function wi(h,e,s,n="green",r=15,i=3){const o=r/2;h.save(),h.beginPath(),h.lineWidth=i,h.strokeStyle=n,h.moveTo(e-o,s-o),h.lineTo(e+o,s+o),h.moveTo(e+o,s-o),h.lineTo(e-o,s+o),h.stroke(),h.restore()}function dt(h,e){h.beginPath(),h.moveTo(e[0].points[0].x,e[0].points[0].y),e.forEach(s=>{switch(s.points.length){case 3:h.quadraticCurveTo(s.points[1].x,s.points[1].y,s.points[2].x,s.points[2].y);break;case 4:h.bezierCurveTo(s.points[1].x,s.points[1].y,s.points[2].x,s.points[2].y,s.points[3].x,s.points[3].y);break}}),h.stroke()}const zi=.1,_i=.75,Mi=5,Ai=.07,Ci=.005;class Si{constructor(){G(this,"position",new $);G(this,"velocity",new $);G(this,"acceleration",new $);G(this,"angle",jt.degToRad(90));G(this,"angularVelocity",0);G(this,"angularAcceleration",0);G(this,"linearVelocity",0);G(this,"linearAcceleration",0)}update(e){this.angularAcceleration=e.x*Ci,this.angularVelocity+=this.angularAcceleration,this.angularVelocity=jt.clamp(this.angularVelocity,-.07,Ai);const s=this.angle+this.angularVelocity;if(this.angle=s,this.angularAcceleration=0,e.x===0&&this.angularVelocity!==0&&(this.angularVelocity=0),this.linearAcceleration=e.y*zi,this.linearVelocity+=this.linearAcceleration,this.linearVelocity=jt.clamp(this.linearVelocity,-5,Mi),this.velocity.set(this.linearVelocity*Math.cos(this.angle),this.linearVelocity*Math.sin(this.angle)),this.position.add(this.velocity),this.linearAcceleration=0,e.y===0&&this.linearVelocity!==0){const n=Math.sign(this.linearVelocity);this.linearVelocity+=-n*_i,n!==Math.sign(this.linearVelocity)&&(this.linearVelocity=0)}}}const bi="#6A2C70",Ei="#F9ED69",zt=50/2,Vt=25/2;function ki(h,e){const s=e.position.x,n=e.position.y;h.save(),h.fillStyle=bi,h.translate(s,n),h.rotate(e.angle),h.translate(-s,-n),h.fillRect(s-zt/2,n-Vt/2,zt,Vt),h.beginPath(),h.moveTo(s-zt/2,n-Vt/2),h.lineTo(s-5-zt/2,n),h.lineTo(s-zt/2,n+Vt/2),h.closePath(),h.fill(),h.restore(),wi(h,e.position.x,e.position.y,Ei,10,1)}class Li{constructor(){G(this,"keys");G(this,"inputVector",new $);this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp),this.keys=new Map,this.initTouchControls()}initTouchControls(){const e=document.querySelector("[data-button-left");e==null||e.addEventListener("pointerdown",r=>{r.preventDefault(),e.classList.add("active"),this.keys.set("ArrowLeft",{isDown:!0,timeStamp:r.timeStamp})}),e==null||e.addEventListener("pointerup",r=>{r.preventDefault(),e.classList.remove("active"),this.keys.get("ArrowLeft")&&(this.keys.get("ArrowLeft").isDown=!1)});const s=document.querySelector("[data-button-right");s==null||s.addEventListener("pointerdown",r=>{s.classList.add("active"),r.preventDefault(),this.keys.set("ArrowRight",{isDown:!0,timeStamp:r.timeStamp})}),s==null||s.addEventListener("pointerup",r=>{r.preventDefault(),s.classList.remove("active"),this.keys.get("ArrowRight")&&(this.keys.get("ArrowRight").isDown=!1)});const n=document.querySelector("[data-button-up");n==null||n.addEventListener("pointerdown",r=>{r.preventDefault(),n.classList.add("active"),this.keys.set("ArrowUp",{isDown:!0,timeStamp:r.timeStamp})}),n==null||n.addEventListener("pointerup",r=>{r.preventDefault(),n.classList.remove("active"),this.keys.get("ArrowUp")&&(this.keys.get("ArrowUp").isDown=!1)})}onKeyDown(e){this.keys.set(e.code,{isDown:!0,timeStamp:e.timeStamp})}onKeyUp(e){this.keys.get(e.code)&&(this.keys.get(e.code).isDown=!1)}updateInputVector(){var n,r,i,o,a,u,f,p,x,v,m,z;let e=0;(n=this.keys.get("ArrowDown"))!=null&&n.isDown&&!((r=this.keys.get("ArrowUp"))!=null&&r.isDown)?e=1:!((i=this.keys.get("ArrowDown"))!=null&&i.isDown)&&((o=this.keys.get("ArrowUp"))!=null&&o.isDown)?e=-1:(a=this.keys.get("ArrowDown"))!=null&&a.isDown&&((u=this.keys.get("ArrowUp"))!=null&&u.isDown)&&(e=this.keys.get("ArrowDown").timeStamp>this.keys.get("ArrowUp").timeStamp?1:-1);let s=0;(f=this.keys.get("ArrowRight"))!=null&&f.isDown&&!((p=this.keys.get("ArrowLeft"))!=null&&p.isDown)?s=1:!((x=this.keys.get("ArrowRight"))!=null&&x.isDown)&&((v=this.keys.get("ArrowLeft"))!=null&&v.isDown)?s=-1:(m=this.keys.get("ArrowRight"))!=null&&m.isDown&&((z=this.keys.get("ArrowLeft"))!=null&&z.isDown)&&(s=this.keys.get("ArrowRight").timeStamp>this.keys.get("ArrowLeft").timeStamp?1:-1),this.inputVector.set(s,e)}}var ne,$e;function Pi(){if($e)return ne;$e=1;function h(n,r){function i(){this.constructor=n}i.prototype=r.prototype,n.prototype=new i}function e(n,r,i,o){this.message=n,this.expected=r,this.found=i,this.location=o,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}h(e,Error),e.buildMessage=function(n,r){var i={literal:function(v){return'"'+a(v.text)+'"'},class:function(v){var m="",z;for(z=0;z<v.parts.length;z++)m+=v.parts[z]instanceof Array?u(v.parts[z][0])+"-"+u(v.parts[z][1]):u(v.parts[z]);return"["+(v.inverted?"^":"")+m+"]"},any:function(v){return"any character"},end:function(v){return"end of input"},other:function(v){return v.description}};function o(v){return v.charCodeAt(0).toString(16).toUpperCase()}function a(v){return v.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+o(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+o(m)})}function u(v){return v.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+o(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+o(m)})}function f(v){return i[v.type](v)}function p(v){var m=new Array(v.length),z,_;for(z=0;z<v.length;z++)m[z]=f(v[z]);if(m.sort(),m.length>0){for(z=1,_=1;z<m.length;z++)m[z-1]!==m[z]&&(m[_]=m[z],_++);m.length=_}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function x(v){return v?'"'+a(v)+'"':"end of input"}return"Expected "+p(n)+" but "+x(r)+" found."};function s(n,r){r=r!==void 0?r:{};var i={},o={svg_path:ve},a=ve,u=function(c){if(!c)return[];for(var l=[],d=0;d<c.length;d++)l=l.concat.apply(l,c[d]);var y=l[0];return y&&y.code=="m"&&(delete y.relative,y.code="M"),l},f=function(c,l){return Ts(c,l)},p=/^[Mm]/,x=Q(["M","m"],!1,!1),v=function(c,l,d){var y=xt(c,[l]);return d&&(y=y.concat(xt(c=="M"?"L":"l",d[1]))),y},m=/^[Zz]/,z=Q(["Z","z"],!1,!1),_=function(){return xt("Z")},S=/^[Ll]/,C=Q(["L","l"],!1,!1),T=function(c,l){return xt(c,l)},P=/^[Hh]/,O=Q(["H","h"],!1,!1),b=function(c,l){return xt(c,l.map(function(d){return{x:d}}))},R=/^[Vv]/,E=Q(["V","v"],!1,!1),k=function(c,l){return xt(c,l.map(function(d){return{y:d}}))},F=/^[Cc]/,N=Q(["C","c"],!1,!1),X=function(c,l,d){return{x1:c.x,y1:c.y,x2:l.x,y2:l.y,x:d.x,y:d.y}},J=/^[Ss]/,Z=Q(["S","s"],!1,!1),W=function(c,l){return{x2:c.x,y2:c.y,x:l.x,y:l.y}},it=/^[Qq]/,at=Q(["Q","q"],!1,!1),ct=function(c,l){return{x1:c.x,y1:c.y,x:l.x,y:l.y}},lt=/^[Tt]/,ut=Q(["T","t"],!1,!1),ft=/^[Aa]/,yt=Q(["A","a"],!1,!1),Ke=function(c,l,d,y,w,M){return{rx:c,ry:l,xAxisRotation:d,largeArc:y,sweep:w,x:M.x,y:M.y}},je=function(c,l){return{x:c,y:l}},ts=function(c){return c*1},es=function(c){return c.join("")*1},ss=/^[01]/,is=Q(["0","1"],!1,!1),ns=function(c){return c=="1"},ue=function(){return""},rs=",",os=ge(",",!1),Jt=function(c){return c.join("")},fe=".",ye=ge(".",!1),hs=/^[eE]/,as=Q(["e","E"],!1,!1),cs=/^[+\-]/,ls=Q(["+","-"],!1,!1),pe=/^[0-9]/,xe=Q([["0","9"]],!1,!1),us=function(c){return c.join("")},fs=/^[ \t\n\r]/,ys=Q([" ","	",`
`,"\r"],!1,!1),g=0,Pt=[{line:1,column:1}],tt=0,Ut=[],Rt;if("startRule"in r){if(!(r.startRule in o))throw new Error(`Can't start parsing from rule "`+r.startRule+'".');a=o[r.startRule]}function ge(c,l){return{type:"literal",text:c,ignoreCase:l}}function Q(c,l,d){return{type:"class",parts:c,inverted:l,ignoreCase:d}}function ps(){return{type:"end"}}function me(c){var l=Pt[c],d;if(l)return l;for(d=c-1;!Pt[d];)d--;for(l=Pt[d],l={line:l.line,column:l.column};d<c;)n.charCodeAt(d)===10?(l.line++,l.column=1):l.column++,d++;return Pt[c]=l,l}function de(c,l){var d=me(c),y=me(l);return{start:{offset:c,line:d.line,column:d.column},end:{offset:l,line:y.line,column:y.column}}}function I(c){g<tt||(g>tt&&(tt=g,Ut=[]),Ut.push(c))}function xs(c,l,d){return new e(e.buildMessage(c,l),c,l,d)}function ve(){var c,l,d,y,w;for(c=g,l=[],d=L();d!==i;)l.push(d),d=L();if(l!==i)if(d=gs(),d===i&&(d=null),d!==i){for(y=[],w=L();w!==i;)y.push(w),w=L();y!==i?(l=u(d),c=l):(g=c,c=i)}else g=c,c=i;else g=c,c=i;return c}function gs(){var c,l,d,y,w,M;if(c=g,l=Xt(),l!==i){for(d=[],y=g,w=[],M=L();M!==i;)w.push(M),M=L();for(w!==i?(M=Xt(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);y!==i;){for(d.push(y),y=g,w=[],M=L();M!==i;)w.push(M),M=L();w!==i?(M=Xt(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i)}d!==i?(l=f(l,d),c=l):(g=c,c=i)}else g=c,c=i;return c}function Xt(){var c,l,d,y,w,M;if(c=g,l=ms(),l!==i){for(d=[],y=g,w=[],M=L();M!==i;)w.push(M),M=L();for(w!==i?(M=we(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);y!==i;){for(d.push(y),y=g,w=[],M=L();M!==i;)w.push(M),M=L();w!==i?(M=we(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i)}d!==i?(l=f(l,d),c=l):(g=c,c=i)}else g=c,c=i;return c}function we(){var c;return c=ds(),c===i&&(c=vs(),c===i&&(c=ws(),c===i&&(c=zs(),c===i&&(c=_s(),c===i&&(c=As(),c===i&&(c=Ss(),c===i&&(c=Es(),c===i&&(c=Ls())))))))),c}function ms(){var c,l,d,y,w,M,gt;if(c=g,p.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(x)),l!==i){for(d=[],y=L();y!==i;)d.push(y),y=L();d!==i?(y=H(),y!==i?(w=g,M=q(),M===i&&(M=null),M!==i?(gt=ze(),gt!==i?(M=[M,gt],w=M):(g=w,w=i)):(g=w,w=i),w===i&&(w=null),w!==i?(l=v(l,y,w),c=l):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)}else g=c,c=i;return c}function ds(){var c,l;return c=g,m.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(z)),l!==i&&(l=_()),c=l,c}function vs(){var c,l,d,y;if(c=g,S.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(C)),l!==i){for(d=[],y=L();y!==i;)d.push(y),y=L();d!==i?(y=ze(),y!==i?(l=T(l,y),c=l):(g=c,c=i)):(g=c,c=i)}else g=c,c=i;return c}function ze(){var c,l,d,y,w,M;if(c=g,l=H(),l!==i){for(d=[],y=g,w=q(),w===i&&(w=null),w!==i?(M=H(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);y!==i;)d.push(y),y=g,w=q(),w===i&&(w=null),w!==i?(M=H(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);d!==i?(l=f(l,d),c=l):(g=c,c=i)}else g=c,c=i;return c}function ws(){var c,l,d,y;if(c=g,P.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(O)),l!==i){for(d=[],y=L();y!==i;)d.push(y),y=L();d!==i?(y=_e(),y!==i?(l=b(l,y),c=l):(g=c,c=i)):(g=c,c=i)}else g=c,c=i;return c}function _e(){var c,l,d,y,w,M;if(c=g,l=pt(),l!==i){for(d=[],y=g,w=q(),w===i&&(w=null),w!==i?(M=pt(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);y!==i;)d.push(y),y=g,w=q(),w===i&&(w=null),w!==i?(M=pt(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);d!==i?(l=f(l,d),c=l):(g=c,c=i)}else g=c,c=i;return c}function zs(){var c,l,d,y;if(c=g,R.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(E)),l!==i){for(d=[],y=L();y!==i;)d.push(y),y=L();d!==i?(y=_e(),y!==i?(l=k(l,y),c=l):(g=c,c=i)):(g=c,c=i)}else g=c,c=i;return c}function _s(){var c,l,d,y;if(c=g,F.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(N)),l!==i){for(d=[],y=L();y!==i;)d.push(y),y=L();d!==i?(y=Ms(),y!==i?(l=T(l,y),c=l):(g=c,c=i)):(g=c,c=i)}else g=c,c=i;return c}function Ms(){var c,l,d,y,w,M;if(c=g,l=Yt(),l!==i){for(d=[],y=g,w=q(),w===i&&(w=null),w!==i?(M=Yt(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);y!==i;)d.push(y),y=g,w=q(),w===i&&(w=null),w!==i?(M=Yt(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);d!==i?(l=f(l,d),c=l):(g=c,c=i)}else g=c,c=i;return c}function Yt(){var c,l,d,y,w,M;return c=g,l=H(),l!==i?(d=q(),d===i&&(d=null),d!==i?(y=H(),y!==i?(w=q(),w===i&&(w=null),w!==i?(M=H(),M!==i?(l=X(l,y,M),c=l):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i),c}function As(){var c,l,d,y;if(c=g,J.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(Z)),l!==i){for(d=[],y=L();y!==i;)d.push(y),y=L();d!==i?(y=Cs(),y!==i?(l=T(l,y),c=l):(g=c,c=i)):(g=c,c=i)}else g=c,c=i;return c}function Cs(){var c,l,d,y,w,M;if(c=g,l=Zt(),l!==i){for(d=[],y=g,w=q(),w===i&&(w=null),w!==i?(M=Zt(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);y!==i;)d.push(y),y=g,w=q(),w===i&&(w=null),w!==i?(M=Zt(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);d!==i?(l=f(l,d),c=l):(g=c,c=i)}else g=c,c=i;return c}function Zt(){var c,l,d,y;return c=g,l=H(),l!==i?(d=q(),d===i&&(d=null),d!==i?(y=H(),y!==i?(l=W(l,y),c=l):(g=c,c=i)):(g=c,c=i)):(g=c,c=i),c}function Ss(){var c,l,d,y;if(c=g,it.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(at)),l!==i){for(d=[],y=L();y!==i;)d.push(y),y=L();d!==i?(y=bs(),y!==i?(l=T(l,y),c=l):(g=c,c=i)):(g=c,c=i)}else g=c,c=i;return c}function bs(){var c,l,d,y,w,M;if(c=g,l=Qt(),l!==i){for(d=[],y=g,w=q(),w===i&&(w=null),w!==i?(M=Qt(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);y!==i;)d.push(y),y=g,w=q(),w===i&&(w=null),w!==i?(M=Qt(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);d!==i?(l=f(l,d),c=l):(g=c,c=i)}else g=c,c=i;return c}function Qt(){var c,l,d,y;return c=g,l=H(),l!==i?(d=q(),d===i&&(d=null),d!==i?(y=H(),y!==i?(l=ct(l,y),c=l):(g=c,c=i)):(g=c,c=i)):(g=c,c=i),c}function Es(){var c,l,d,y;if(c=g,lt.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(ut)),l!==i){for(d=[],y=L();y!==i;)d.push(y),y=L();d!==i?(y=ks(),y!==i?(l=T(l,y),c=l):(g=c,c=i)):(g=c,c=i)}else g=c,c=i;return c}function ks(){var c,l,d,y,w,M;if(c=g,l=H(),l!==i){for(d=[],y=g,w=q(),w===i&&(w=null),w!==i?(M=H(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);y!==i;)d.push(y),y=g,w=q(),w===i&&(w=null),w!==i?(M=H(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);d!==i?(l=f(l,d),c=l):(g=c,c=i)}else g=c,c=i;return c}function Ls(){var c,l,d,y;if(c=g,ft.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(yt)),l!==i){for(d=[],y=L();y!==i;)d.push(y),y=L();d!==i?(y=Ps(),y!==i?(l=T(l,y),c=l):(g=c,c=i)):(g=c,c=i)}else g=c,c=i;return c}function Ps(){var c,l,d,y,w,M;if(c=g,l=Ht(),l!==i){for(d=[],y=g,w=q(),w===i&&(w=null),w!==i?(M=Ht(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);y!==i;)d.push(y),y=g,w=q(),w===i&&(w=null),w!==i?(M=Ht(),M!==i?(w=[w,M],y=w):(g=y,y=i)):(g=y,y=i);d!==i?(l=f(l,d),c=l):(g=c,c=i)}else g=c,c=i;return c}function Ht(){var c,l,d,y,w,M,gt,Gt,$t,Bt,Dt,Kt;return c=g,l=Me(),l!==i?(d=q(),d===i&&(d=null),d!==i?(y=Me(),y!==i?(w=q(),w===i&&(w=null),w!==i?(M=pt(),M!==i?(gt=q(),gt!==i?(Gt=Ae(),Gt!==i?($t=q(),$t===i&&($t=null),$t!==i?(Bt=Ae(),Bt!==i?(Dt=q(),Dt===i&&(Dt=null),Dt!==i?(Kt=H(),Kt!==i?(l=Ke(l,y,M,Gt,Bt,Kt),c=l):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i)):(g=c,c=i),c}function H(){var c,l,d,y;return c=g,l=pt(),l!==i?(d=q(),d===i&&(d=null),d!==i?(y=pt(),y!==i?(l=je(l,y),c=l):(g=c,c=i)):(g=c,c=i)):(g=c,c=i),c}function Me(){var c,l;return c=g,l=Se(),l===i&&(l=ht()),l!==i&&(l=ts(l)),c=l,c}function pt(){var c,l,d,y;return c=g,l=g,d=Wt(),d===i&&(d=null),d!==i?(y=Se(),y!==i?(d=[d,y],l=d):(g=l,l=i)):(g=l,l=i),l===i&&(l=g,d=Wt(),d===i&&(d=null),d!==i?(y=ht(),y!==i?(d=[d,y],l=d):(g=l,l=i)):(g=l,l=i)),l!==i&&(l=es(l)),c=l,c}function Ae(){var c,l;return c=g,ss.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(is)),l!==i&&(l=ns(l)),c=l,c}function q(){var c,l,d,y,w;if(c=g,l=[],d=L(),d!==i)for(;d!==i;)l.push(d),d=L();else l=i;if(l!==i)if(d=Ce(),d===i&&(d=null),d!==i){for(y=[],w=L();w!==i;)y.push(w),w=L();y!==i?(l=[l,d,y],c=l):(g=c,c=i)}else g=c,c=i;else g=c,c=i;if(c===i){if(c=g,l=g,d=Ce(),d!==i){for(y=[],w=L();w!==i;)y.push(w),w=L();y!==i?(d=[d,y],l=d):(g=l,l=i)}else g=l,l=i;l!==i&&(l=ue()),c=l}return c}function Ce(){var c;return n.charCodeAt(g)===44?(c=rs,g++):(c=i,I(os)),c}function Se(){var c,l,d,y;return c=g,l=g,d=Rs(),d!==i?(y=be(),y===i&&(y=null),y!==i?(d=[d,y],l=d):(g=l,l=i)):(g=l,l=i),l===i&&(l=g,d=ht(),d!==i?(y=be(),y!==i?(d=[d,y],l=d):(g=l,l=i)):(g=l,l=i)),l!==i&&(l=Jt(l)),c=l,c}function Rs(){var c,l,d,y,w;return c=g,l=g,d=ht(),d===i&&(d=null),d!==i?(n.charCodeAt(g)===46?(y=fe,g++):(y=i,I(ye)),y!==i?(w=ht(),w!==i?(d=[d,y,w],l=d):(g=l,l=i)):(g=l,l=i)):(g=l,l=i),l===i&&(l=g,d=ht(),d!==i?(n.charCodeAt(g)===46?(y=fe,g++):(y=i,I(ye)),y!==i?(d=[d,y],l=d):(g=l,l=i)):(g=l,l=i)),l!==i&&(l=Jt(l)),c=l,c}function be(){var c,l,d,y,w;return c=g,l=g,hs.test(n.charAt(g))?(d=n.charAt(g),g++):(d=i,I(as)),d!==i?(y=Wt(),y===i&&(y=null),y!==i?(w=ht(),w!==i?(d=[d,y,w],l=d):(g=l,l=i)):(g=l,l=i)):(g=l,l=i),l!==i&&(l=Jt(l)),c=l,c}function Wt(){var c;return cs.test(n.charAt(g))?(c=n.charAt(g),g++):(c=i,I(ls)),c}function ht(){var c,l,d;if(c=g,l=[],pe.test(n.charAt(g))?(d=n.charAt(g),g++):(d=i,I(xe)),d!==i)for(;d!==i;)l.push(d),pe.test(n.charAt(g))?(d=n.charAt(g),g++):(d=i,I(xe));else l=i;return l!==i&&(l=us(l)),c=l,c}function L(){var c,l;return c=g,fs.test(n.charAt(g))?(l=n.charAt(g),g++):(l=i,I(ys)),l!==i&&(l=ue()),c=l,c}function Ts(c,l){if(!l)return[c];for(var d=[c],y=0,w=l.length;y<w;y++)d[y+1]=l[y][1];return d}var Tt={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var Ee in Tt)Tt[Ee.toUpperCase()]=Tt[Ee];function xt(c,l){l||(l=[{}]);for(var d=l.length;d--;){var y={code:c,command:Tt[c]};c==c.toLowerCase()&&(y.relative=!0);for(var w in l[d])y[w]=l[d][w];l[d]=y}return l}if(Rt=a(),Rt!==i&&g===n.length)return Rt;throw Rt!==i&&g<n.length&&I(ps()),xs(Ut,tt<n.length?n.charAt(tt):null,tt<n.length?de(tt,tt+1):de(tt,tt))}return ne={SyntaxError:e,parse:s},ne}var re,De;function Ri(){if(De)return re;De=1;var h=Pi().parse;h.parseSVG=h,h.makeAbsolute=e,re=h;function e(s){var n,r={x:0,y:0},i={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return s.forEach(function(o){o.command==="moveto"&&(n=o),o.x0=r.x,o.y0=r.y;for(var a in i)a in o&&(o[a]+=o.relative?o[i[a]]:0);"x"in o||(o.x=r.x),"y"in o||(o.y=r.y),o.relative=!1,o.code=o.code.toUpperCase(),o.command=="closepath"&&(o.x=n.x,o.y=n.y),r=o}),s}return re}var Oe=Ri();const{abs:_t,cos:st,sin:vt,acos:Ti,atan2:Mt,sqrt:rt,pow:K}=Math;function At(h){return h<0?-K(-h,1/3):K(h,1/3)}const He=Math.PI,Ft=2*He,ot=He/2,$i=1e-6,oe=Number.MAX_SAFE_INTEGER||9007199254740991,he=Number.MIN_SAFE_INTEGER||-9007199254740991,Di={x:0,y:0,z:0},A={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(h,e){const s=e(h);let n=s.x*s.x+s.y*s.y;return typeof s.z<"u"&&(n+=s.z*s.z),rt(n)},compute:function(h,e,s){if(h===0)return e[0].t=0,e[0];const n=e.length-1;if(h===1)return e[n].t=1,e[n];const r=1-h;let i=e;if(n===0)return e[0].t=h,e[0];if(n===1){const a={x:r*i[0].x+h*i[1].x,y:r*i[0].y+h*i[1].y,t:h};return s&&(a.z=r*i[0].z+h*i[1].z),a}if(n<4){let a=r*r,u=h*h,f,p,x,v=0;n===2?(i=[i[0],i[1],i[2],Di],f=a,p=r*h*2,x=u):n===3&&(f=a*r,p=a*h*3,x=r*u*3,v=h*u);const m={x:f*i[0].x+p*i[1].x+x*i[2].x+v*i[3].x,y:f*i[0].y+p*i[1].y+x*i[2].y+v*i[3].y,t:h};return s&&(m.z=f*i[0].z+p*i[1].z+x*i[2].z+v*i[3].z),m}const o=JSON.parse(JSON.stringify(e));for(;o.length>1;){for(let a=0;a<o.length-1;a++)o[a]={x:o[a].x+(o[a+1].x-o[a].x)*h,y:o[a].y+(o[a+1].y-o[a].y)*h},typeof o[a].z<"u"&&(o[a].z=o[a].z+(o[a+1].z-o[a].z)*h);o.splice(o.length-1,1)}return o[0].t=h,o[0]},computeWithRatios:function(h,e,s,n){const r=1-h,i=s,o=e;let a=i[0],u=i[1],f=i[2],p=i[3],x;if(a*=r,u*=h,o.length===2)return x=a+u,{x:(a*o[0].x+u*o[1].x)/x,y:(a*o[0].y+u*o[1].y)/x,z:n?(a*o[0].z+u*o[1].z)/x:!1,t:h};if(a*=r,u*=2*r,f*=h*h,o.length===3)return x=a+u+f,{x:(a*o[0].x+u*o[1].x+f*o[2].x)/x,y:(a*o[0].y+u*o[1].y+f*o[2].y)/x,z:n?(a*o[0].z+u*o[1].z+f*o[2].z)/x:!1,t:h};if(a*=r,u*=1.5*r,f*=3*r,p*=h*h*h,o.length===4)return x=a+u+f+p,{x:(a*o[0].x+u*o[1].x+f*o[2].x+p*o[3].x)/x,y:(a*o[0].y+u*o[1].y+f*o[2].y+p*o[3].y)/x,z:n?(a*o[0].z+u*o[1].z+f*o[2].z+p*o[3].z)/x:!1,t:h}},derive:function(h,e){const s=[];for(let n=h,r=n.length,i=r-1;r>1;r--,i--){const o=[];for(let a=0,u;a<i;a++)u={x:i*(n[a+1].x-n[a].x),y:i*(n[a+1].y-n[a].y)},e&&(u.z=i*(n[a+1].z-n[a].z)),o.push(u);s.push(o),n=o}return s},between:function(h,e,s){return e<=h&&h<=s||A.approximately(h,e)||A.approximately(h,s)},approximately:function(h,e,s){return _t(h-e)<=(s||$i)},length:function(h){const s=A.Tvalues.length;let n=0;for(let r=0,i;r<s;r++)i=.5*A.Tvalues[r]+.5,n+=A.Cvalues[r]*A.arcfn(i,h);return .5*n},map:function(h,e,s,n,r){const i=s-e,o=r-n,a=h-e,u=a/i;return n+o*u},lerp:function(h,e,s){const n={x:e.x+h*(s.x-e.x),y:e.y+h*(s.y-e.y)};return e.z!==void 0&&s.z!==void 0&&(n.z=e.z+h*(s.z-e.z)),n},pointToString:function(h){let e=h.x+"/"+h.y;return typeof h.z<"u"&&(e+="/"+h.z),e},pointsToString:function(h){return"["+h.map(A.pointToString).join(", ")+"]"},copy:function(h){return JSON.parse(JSON.stringify(h))},angle:function(h,e,s){const n=e.x-h.x,r=e.y-h.y,i=s.x-h.x,o=s.y-h.y,a=n*o-r*i,u=n*i+r*o;return Mt(a,u)},round:function(h,e){const s=""+h,n=s.indexOf(".");return parseFloat(s.substring(0,n+1+e))},dist:function(h,e){const s=h.x-e.x,n=h.y-e.y;return rt(s*s+n*n)},closest:function(h,e){let s=K(2,63),n,r;return h.forEach(function(i,o){r=A.dist(e,i),r<s&&(s=r,n=o)}),{mdist:s,mpos:n}},abcratio:function(h,e){if(e!==2&&e!==3)return!1;if(typeof h>"u")h=.5;else if(h===0||h===1)return h;const s=K(h,e)+K(1-h,e),n=s-1;return _t(n/s)},projectionratio:function(h,e){if(e!==2&&e!==3)return!1;if(typeof h>"u")h=.5;else if(h===0||h===1)return h;const s=K(1-h,e),n=K(h,e)+s;return s/n},lli8:function(h,e,s,n,r,i,o,a){const u=(h*n-e*s)*(r-o)-(h-s)*(r*a-i*o),f=(h*n-e*s)*(i-a)-(e-n)*(r*a-i*o),p=(h-s)*(i-a)-(e-n)*(r-o);return p==0?!1:{x:u/p,y:f/p}},lli4:function(h,e,s,n){const r=h.x,i=h.y,o=e.x,a=e.y,u=s.x,f=s.y,p=n.x,x=n.y;return A.lli8(r,i,o,a,u,f,p,x)},lli:function(h,e){return A.lli4(h,h.c,e,e.c)},makeline:function(h,e){return new V(h.x,h.y,(h.x+e.x)/2,(h.y+e.y)/2,e.x,e.y)},findbbox:function(h){let e=oe,s=oe,n=he,r=he;return h.forEach(function(i){const o=i.bbox();e>o.x.min&&(e=o.x.min),s>o.y.min&&(s=o.y.min),n<o.x.max&&(n=o.x.max),r<o.y.max&&(r=o.y.max)}),{x:{min:e,mid:(e+n)/2,max:n,size:n-e},y:{min:s,mid:(s+r)/2,max:r,size:r-s}}},shapeintersections:function(h,e,s,n,r){if(!A.bboxoverlap(e,n))return[];const i=[],o=[h.startcap,h.forward,h.back,h.endcap],a=[s.startcap,s.forward,s.back,s.endcap];return o.forEach(function(u){u.virtual||a.forEach(function(f){if(f.virtual)return;const p=u.intersects(f,r);p.length>0&&(p.c1=u,p.c2=f,p.s1=h,p.s2=s,i.push(p))})}),i},makeshape:function(h,e,s){const n=e.points.length,r=h.points.length,i=A.makeline(e.points[n-1],h.points[0]),o=A.makeline(h.points[r-1],e.points[0]),a={startcap:i,forward:h,back:e,endcap:o,bbox:A.findbbox([i,h,e,o])};return a.intersections=function(u){return A.shapeintersections(a,a.bbox,u,u.bbox,s)},a},getminmax:function(h,e,s){if(!s)return{min:0,max:0};let n=oe,r=he,i,o;s.indexOf(0)===-1&&(s=[0].concat(s)),s.indexOf(1)===-1&&s.push(1);for(let a=0,u=s.length;a<u;a++)i=s[a],o=h.get(i),o[e]<n&&(n=o[e]),o[e]>r&&(r=o[e]);return{min:n,mid:(n+r)/2,max:r,size:r-n}},align:function(h,e){const s=e.p1.x,n=e.p1.y,r=-Mt(e.p2.y-n,e.p2.x-s),i=function(o){return{x:(o.x-s)*st(r)-(o.y-n)*vt(r),y:(o.x-s)*vt(r)+(o.y-n)*st(r)}};return h.map(i)},roots:function(h,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const s=h.length-1,n=A.align(h,e),r=function(E){return 0<=E&&E<=1};if(s===2){const E=n[0].y,k=n[1].y,F=n[2].y,N=E-2*k+F;if(N!==0){const X=-rt(k*k-E*F),J=-E+k,Z=-(X+J)/N,W=-(-X+J)/N;return[Z,W].filter(r)}else if(k!==F&&N===0)return[(2*k-F)/(2*k-2*F)].filter(r);return[]}const i=n[0].y,o=n[1].y,a=n[2].y,u=n[3].y;let f=-i+3*o-3*a+u,p=3*i-6*o+3*a,x=-3*i+3*o,v=i;if(A.approximately(f,0)){if(A.approximately(p,0))return A.approximately(x,0)?[]:[-v/x].filter(r);const E=rt(x*x-4*p*v),k=2*p;return[(E-x)/k,(-x-E)/k].filter(r)}p/=f,x/=f,v/=f;const m=(3*x-p*p)/3,z=m/3,_=(2*p*p*p-9*p*x+27*v)/27,S=_/2,C=S*S+z*z*z;let T,P,O,b,R;if(C<0){const E=-m/3,k=E*E*E,F=rt(k),N=-_/(2*F),X=N<-1?-1:N>1?1:N,J=Ti(X),Z=At(F),W=2*Z;return O=W*st(J/3)-p/3,b=W*st((J+Ft)/3)-p/3,R=W*st((J+2*Ft)/3)-p/3,[O,b,R].filter(r)}else{if(C===0)return T=S<0?At(-S):-At(S),O=2*T-p/3,b=-T-p/3,[O,b].filter(r);{const E=rt(C);return T=At(-S+E),P=At(S+E),[T-P-p/3].filter(r)}}},droots:function(h){if(h.length===3){const e=h[0],s=h[1],n=h[2],r=e-2*s+n;if(r!==0){const i=-rt(s*s-e*n),o=-e+s,a=-(i+o)/r,u=-(-i+o)/r;return[a,u]}else if(s!==n&&r===0)return[(2*s-n)/(2*(s-n))];return[]}if(h.length===2){const e=h[0],s=h[1];return e!==s?[e/(e-s)]:[]}return[]},curvature:function(h,e,s,n,r){let i,o,a,u,f=0,p=0;const x=A.compute(h,e),v=A.compute(h,s),m=x.x*x.x+x.y*x.y;if(n?(i=rt(K(x.y*v.z-v.y*x.z,2)+K(x.z*v.x-v.z*x.x,2)+K(x.x*v.y-v.x*x.y,2)),o=K(m+x.z*x.z,3/2)):(i=x.x*v.y-x.y*v.x,o=K(m,3/2)),i===0||o===0)return{k:0,r:0};if(f=i/o,p=o/i,!r){const z=A.curvature(h-.001,e,s,n,!0).k,_=A.curvature(h+.001,e,s,n,!0).k;u=(_-f+(f-z))/2,a=(_t(_-f)+_t(f-z))/2}return{k:f,r:p,dk:u,adk:a}},inflections:function(h){if(h.length<4)return[];const e=A.align(h,{p1:h[0],p2:h.slice(-1)[0]}),s=e[2].x*e[1].y,n=e[3].x*e[1].y,r=e[1].x*e[2].y,i=e[3].x*e[2].y,o=18*(-3*s+2*n+3*r-i),a=18*(3*s-n-3*r),u=18*(r-s);if(A.approximately(o,0)){if(!A.approximately(a,0)){let v=-u/a;if(0<=v&&v<=1)return[v]}return[]}const f=2*o;if(A.approximately(f,0))return[];const p=a*a-4*o*u;if(p<0)return[];const x=Math.sqrt(p);return[(x-a)/f,-(a+x)/f].filter(function(v){return 0<=v&&v<=1})},bboxoverlap:function(h,e){const s=["x","y"],n=s.length;for(let r=0,i,o,a,u;r<n;r++)if(i=s[r],o=h[i].mid,a=e[i].mid,u=(h[i].size+e[i].size)/2,_t(o-a)>=u)return!1;return!0},expandbox:function(h,e){e.x.min<h.x.min&&(h.x.min=e.x.min),e.y.min<h.y.min&&(h.y.min=e.y.min),e.z&&e.z.min<h.z.min&&(h.z.min=e.z.min),e.x.max>h.x.max&&(h.x.max=e.x.max),e.y.max>h.y.max&&(h.y.max=e.y.max),e.z&&e.z.max>h.z.max&&(h.z.max=e.z.max),h.x.mid=(h.x.min+h.x.max)/2,h.y.mid=(h.y.min+h.y.max)/2,h.z&&(h.z.mid=(h.z.min+h.z.max)/2),h.x.size=h.x.max-h.x.min,h.y.size=h.y.max-h.y.min,h.z&&(h.z.size=h.z.max-h.z.min)},pairiteration:function(h,e,s){const n=h.bbox(),r=e.bbox(),i=1e5,o=s||.5;if(n.x.size+n.y.size<o&&r.x.size+r.y.size<o)return[(i*(h._t1+h._t2)/2|0)/i+"/"+(i*(e._t1+e._t2)/2|0)/i];let a=h.split(.5),u=e.split(.5),f=[{left:a.left,right:u.left},{left:a.left,right:u.right},{left:a.right,right:u.right},{left:a.right,right:u.left}];f=f.filter(function(x){return A.bboxoverlap(x.left.bbox(),x.right.bbox())});let p=[];return f.length===0||(f.forEach(function(x){p=p.concat(A.pairiteration(x.left,x.right,o))}),p=p.filter(function(x,v){return p.indexOf(x)===v})),p},getccenter:function(h,e,s){const n=e.x-h.x,r=e.y-h.y,i=s.x-e.x,o=s.y-e.y,a=n*st(ot)-r*vt(ot),u=n*vt(ot)+r*st(ot),f=i*st(ot)-o*vt(ot),p=i*vt(ot)+o*st(ot),x=(h.x+e.x)/2,v=(h.y+e.y)/2,m=(e.x+s.x)/2,z=(e.y+s.y)/2,_=x+a,S=v+u,C=m+f,T=z+p,P=A.lli8(x,v,_,S,m,z,C,T),O=A.dist(P,h);let b=Mt(h.y-P.y,h.x-P.x),R=Mt(e.y-P.y,e.x-P.x),E=Mt(s.y-P.y,s.x-P.x),k;return b<E?((b>R||R>E)&&(b+=Ft),b>E&&(k=E,E=b,b=k)):E<R&&R<b?(k=E,E=b,b=k):E+=Ft,P.s=b,P.e=E,P.r=O,P},numberSort:function(h,e){return h-e}};class kt{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return A.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,s){return e+s})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var s=e[0].bbox(),n=1;n<e.length;n++)A.expandbox(s,e[n].bbox());return s}offset(e){const s=[];return this.curves.forEach(function(n){s.push(...n.offset(e))}),new kt(s)}}const{abs:Ct,min:Ne,max:qe,cos:Oi,sin:Ni,acos:qi,sqrt:St}=Math,Vi=Math.PI;class V{constructor(e){let s=e&&e.forEach?e:Array.from(arguments).slice(),n=!1;if(typeof s[0]=="object"){n=s.length;const m=[];s.forEach(function(z){["x","y","z"].forEach(function(_){typeof z[_]<"u"&&m.push(z[_])})}),s=m}let r=!1;const i=s.length;if(n){if(n>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");r=!0}}else if(i!==6&&i!==8&&i!==9&&i!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!r&&(i===9||i===12)||e&&e[0]&&typeof e[0].z<"u",a=this.points=[];for(let m=0,z=o?3:2;m<i;m+=z){var u={x:s[m],y:s[m+1]};o&&(u.z=s[m+2]),a.push(u)}const f=this.order=a.length-1,p=this.dims=["x","y"];o&&p.push("z"),this.dimlen=p.length;const x=A.align(a,{p1:a[0],p2:a[f]}),v=A.dist(a[0],a[f]);this._linear=x.reduce((m,z)=>m+Ct(z.y),0)<v/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,s,n,r){if(typeof r>"u"&&(r=.5),r===0)return new V(s,s,n);if(r===1)return new V(e,s,s);const i=V.getABC(2,e,s,n,r);return new V(e,i.A,n)}static cubicFromPoints(e,s,n,r,i){typeof r>"u"&&(r=.5);const o=V.getABC(3,e,s,n,r);typeof i>"u"&&(i=A.dist(s,o.C));const a=i*(1-r)/r,u=A.dist(e,n),f=(n.x-e.x)/u,p=(n.y-e.y)/u,x=i*f,v=i*p,m=a*f,z=a*p,_={x:s.x-x,y:s.y-v},S={x:s.x+m,y:s.y+z},C=o.A,T={x:C.x+(_.x-C.x)/(1-r),y:C.y+(_.y-C.y)/(1-r)},P={x:C.x+(S.x-C.x)/r,y:C.y+(S.y-C.y)/r},O={x:e.x+(T.x-e.x)/r,y:e.y+(T.y-e.y)/r},b={x:n.x+(P.x-n.x)/(1-r),y:n.y+(P.y-n.y)/(1-r)};return new V(e,O,b,n)}static getUtils(){return A}getUtils(){return V.getUtils()}static get PolyBezier(){return kt}valueOf(){return this.toString()}toString(){return A.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,s=e[0].x,n=e[0].y,r=["M",s,n,this.order===2?"Q":"C"];for(let i=1,o=e.length;i<o;i++)r.push(e[i].x),r.push(e[i].y);return r.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,s){return""+s+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=A.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,s=A.angle(e[0],e[this.order],e[1]);this.clockwise=s>0}length(){return A.length(this.derivative.bind(this))}static getABC(e=2,s,n,r,i=.5){const o=A.projectionratio(i,e),a=1-o,u={x:o*s.x+a*r.x,y:o*s.y+a*r.y},f=A.abcratio(i,e);return{A:{x:n.x+(n.x-u.x)/f,y:n.y+(n.y-u.y)/f},B:n,C:u,S:s,E:r}}getABC(e,s){s=s||this.get(e);let n=this.points[0],r=this.points[this.order];return V.getABC(this.order,n,s,r,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let s=0,n,r;s<e;s++)r=s/(e-1),n=this.compute(r),n.t=r,this._lut.push(n);return this._lut}on(e,s){s=s||5;const n=this.getLUT(),r=[];for(let i=0,o,a=0;i<n.length;i++)o=n[i],A.dist(o,e)<s&&(r.push(o),a+=i/n.length);return r.length?t/=r.length:!1}project(e){const s=this.getLUT(),n=s.length-1,r=A.closest(s,e),i=r.mpos,o=(i-1)/n,a=(i+1)/n,u=.1/n;let f=r.mdist,p=o,x=p,v;f+=1;for(let m;p<a+u;p+=u)v=this.compute(p),m=A.dist(e,v),m<f&&(f=m,x=p);return x=x<0?0:x>1?1:x,v=this.compute(x),v.t=x,v.d=f,v}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?A.computeWithRatios(e,this.points,this.ratios,this._3d):A.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,s=[e[0]],n=e.length;for(let r=1,i,o;r<n;r++)i=e[r],o=e[r-1],s[r]={x:(n-r)/n*i.x+r/n*o.x,y:(n-r)/n*i.y+r/n*o.y};return s[n]=e[n-1],new V(s)}derivative(e){return A.compute(e,this.dpoints[0],this._3d)}dderivative(e){return A.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new V(A.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return A.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return A.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const s=this.derivative(e),n=St(s.x*s.x+s.y*s.y);return{t:e,x:-s.y/n,y:s.x/n}}__normal3(e){const s=this.derivative(e),n=this.derivative(e+.01),r=St(s.x*s.x+s.y*s.y+s.z*s.z),i=St(n.x*n.x+n.y*n.y+n.z*n.z);s.x/=r,s.y/=r,s.z/=r,n.x/=i,n.y/=i,n.z/=i;const o={x:n.y*s.z-n.z*s.y,y:n.z*s.x-n.x*s.z,z:n.x*s.y-n.y*s.x},a=St(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=a,o.y/=a,o.z/=a;const u=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:e,x:u[0]*s.x+u[1]*s.y+u[2]*s.z,y:u[3]*s.x+u[4]*s.y+u[5]*s.z,z:u[6]*s.x+u[7]*s.y+u[8]*s.z}}hull(e){let s=this.points,n=[],r=[],i=0;for(r[i++]=s[0],r[i++]=s[1],r[i++]=s[2],this.order===3&&(r[i++]=s[3]);s.length>1;){n=[];for(let o=0,a,u=s.length-1;o<u;o++)a=A.lerp(e,s[o],s[o+1]),r[i++]=a,n.push(a);s=n}return r}split(e,s){if(e===0&&s)return this.split(s).left;if(s===1)return this.split(e).right;const n=this.hull(e),r={left:this.order===2?new V([n[0],n[3],n[5]]):new V([n[0],n[4],n[7],n[9]]),right:this.order===2?new V([n[5],n[4],n[2]]):new V([n[9],n[8],n[6],n[3]]),span:n};return r.left._t1=A.map(0,0,1,this._t1,this._t2),r.left._t2=A.map(e,0,1,this._t1,this._t2),r.right._t1=A.map(e,0,1,this._t1,this._t2),r.right._t2=A.map(1,0,1,this._t1,this._t2),s?(s=A.map(s,e,1,0,1),r.right.split(s).left):r}extrema(){const e={};let s=[];return this.dims.forEach((function(n){let r=function(o){return o[n]},i=this.dpoints[0].map(r);e[n]=A.droots(i),this.order===3&&(i=this.dpoints[1].map(r),e[n]=e[n].concat(A.droots(i))),e[n]=e[n].filter(function(o){return o>=0&&o<=1}),s=s.concat(e[n].sort(A.numberSort))}).bind(this)),e.values=s.sort(A.numberSort).filter(function(n,r){return s.indexOf(n)===r}),e}bbox(){const e=this.extrema(),s={};return this.dims.forEach((function(n){s[n]=A.getminmax(this,n,e[n])}).bind(this)),s}overlaps(e){const s=this.bbox(),n=e.bbox();return A.bboxoverlap(s,n)}offset(e,s){if(typeof s<"u"){const n=this.get(e),r=this.normal(e),i={c:n,n:r,x:n.x+r.x*s,y:n.y+r.y*s};return this._3d&&(i.z=n.z+r.z*s),i}if(this._linear){const n=this.normal(0),r=this.points.map(function(i){const o={x:i.x+e*n.x,y:i.y+e*n.y};return i.z&&n.z&&(o.z=i.z+e*n.z),o});return[new V(r)]}return this.reduce().map(function(n){return n._linear?n.offset(e)[0]:n.scale(e)})}simple(){if(this.order===3){const r=A.angle(this.points[0],this.points[3],this.points[1]),i=A.angle(this.points[0],this.points[3],this.points[2]);if(r>0&&i<0||r<0&&i>0)return!1}const e=this.normal(0),s=this.normal(1);let n=e.x*s.x+e.y*s.y;return this._3d&&(n+=e.z*s.z),Ct(qi(n))<Vi/3}reduce(){let e,s=0,n=0,r=.01,i,o=[],a=[],u=this.extrema().values;for(u.indexOf(0)===-1&&(u=[0].concat(u)),u.indexOf(1)===-1&&u.push(1),s=u[0],e=1;e<u.length;e++)n=u[e],i=this.split(s,n),i._t1=s,i._t2=n,o.push(i),s=n;return o.forEach(function(f){for(s=0,n=0;n<=1;)for(n=s+r;n<=1+r;n+=r)if(i=f.split(s,n),!i.simple()){if(n-=r,Ct(s-n)<r)return[];i=f.split(s,n),i._t1=A.map(s,0,1,f._t1,f._t2),i._t2=A.map(n,0,1,f._t1,f._t2),a.push(i),s=n;break}s<1&&(i=f.split(s,1),i._t1=A.map(s,0,1,f._t1,f._t2),i._t2=f._t2,a.push(i))}),a}translate(e,s,n){n=typeof n=="number"?n:s;const r=this.order;let i=this.points.map((o,a)=>(1-a/r)*s+a/r*n);return new V(this.points.map((o,a)=>({x:o.x+e.x*i[a],y:o.y+e.y*i[a]})))}scale(e){const s=this.order;let n=!1;if(typeof e=="function"&&(n=e),n&&s===2)return this.raise().scale(n);const r=this.clockwise,i=this.points;if(this._linear)return this.translate(this.normal(0),n?n(0):e,n?n(1):e);const o=n?n(0):e,a=n?n(1):e,u=[this.offset(0,10),this.offset(1,10)],f=[],p=A.lli4(u[0],u[0].c,u[1],u[1].c);if(!p)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(x){const v=f[x*s]=A.copy(i[x*s]);v.x+=(x?a:o)*u[x].n.x,v.y+=(x?a:o)*u[x].n.y}),n?([0,1].forEach(function(x){if(!(s===2&&x)){var v=i[x+1],m={x:v.x-p.x,y:v.y-p.y},z=n?n((x+1)/s):e;n&&!r&&(z=-z);var _=St(m.x*m.x+m.y*m.y);m.x/=_,m.y/=_,f[x+1]={x:v.x+z*m.x,y:v.y+z*m.y}}}),new V(f)):([0,1].forEach(x=>{if(s===2&&x)return;const v=f[x*s],m=this.derivative(x),z={x:v.x+m.x,y:v.y+m.y};f[x+1]=A.lli4(v,z,p,i[x+1])}),new V(f))}outline(e,s,n,r){if(s=s===void 0?e:s,this._linear){const b=this.normal(0),R=this.points[0],E=this.points[this.points.length-1];let k,F,N;n===void 0&&(n=e,r=s),k={x:R.x+b.x*e,y:R.y+b.y*e},N={x:E.x+b.x*n,y:E.y+b.y*n},F={x:(k.x+N.x)/2,y:(k.y+N.y)/2};const X=[k,F,N];k={x:R.x-b.x*s,y:R.y-b.y*s},N={x:E.x-b.x*r,y:E.y-b.y*r},F={x:(k.x+N.x)/2,y:(k.y+N.y)/2};const J=[N,F,k],Z=A.makeline(J[2],X[0]),W=A.makeline(X[2],J[0]),it=[Z,new V(X),W,new V(J)];return new kt(it)}const i=this.reduce(),o=i.length,a=[];let u=[],f,p=0,x=this.length();const v=typeof n<"u"&&typeof r<"u";function m(b,R,E,k,F){return function(N){const X=k/E,J=(k+F)/E,Z=R-b;return A.map(N,0,1,b+X*Z,b+J*Z)}}i.forEach(function(b){const R=b.length();v?(a.push(b.scale(m(e,n,x,p,R))),u.push(b.scale(m(-s,-r,x,p,R)))):(a.push(b.scale(e)),u.push(b.scale(-s))),p+=R}),u=u.map(function(b){return f=b.points,f[3]?b.points=[f[3],f[2],f[1],f[0]]:b.points=[f[2],f[1],f[0]],b}).reverse();const z=a[0].points[0],_=a[o-1].points[a[o-1].points.length-1],S=u[o-1].points[u[o-1].points.length-1],C=u[0].points[0],T=A.makeline(S,z),P=A.makeline(_,C),O=[T].concat(a).concat([P]).concat(u);return new kt(O)}outlineshapes(e,s,n){s=s||e;const r=this.outline(e,s).curves,i=[];for(let o=1,a=r.length;o<a/2;o++){const u=A.makeshape(r[o],r[a-o],n);u.startcap.virtual=o>1,u.endcap.virtual=o<a/2-1,i.push(u)}return i}intersects(e,s){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof V&&(e=e.reduce()),this.curveintersects(this.reduce(),e,s)):this.selfintersects(s)}lineIntersects(e){const s=Ne(e.p1.x,e.p2.x),n=Ne(e.p1.y,e.p2.y),r=qe(e.p1.x,e.p2.x),i=qe(e.p1.y,e.p2.y);return A.roots(this.points,e).filter(o=>{var a=this.get(o);return A.between(a.x,s,r)&&A.between(a.y,n,i)})}selfintersects(e){const s=this.reduce(),n=s.length-2,r=[];for(let i=0,o,a,u;i<n;i++)a=s.slice(i,i+1),u=s.slice(i+2),o=this.curveintersects(a,u,e),r.push(...o);return r}curveintersects(e,s,n){const r=[];e.forEach(function(o){s.forEach(function(a){o.overlaps(a)&&r.push({left:o,right:a})})});let i=[];return r.forEach(function(o){const a=A.pairiteration(o.left,o.right,n);a.length>0&&(i=i.concat(a))}),i}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,s,n,r){const i=(r-n)/4,o=this.get(n+i),a=this.get(r-i),u=A.dist(e,s),f=A.dist(e,o),p=A.dist(e,a);return Ct(f-u)+Ct(p-u)}_iterate(e,s){let n=0,r=1,i;do{i=0,r=1;let o=this.get(n),a,u,f,p,x=!1,v=!1,m,z=r,_=1;do if(v=x,p=f,z=(n+r)/2,a=this.get(z),u=this.get(r),f=A.getccenter(o,a,u),f.interval={start:n,end:r},x=this._error(f,o,n,r)<=e,m=v&&!x,m||(_=r),x){if(r>=1){if(f.interval.end=_=1,p=f,r>1){let C={x:f.x+f.r*Oi(f.e),y:f.y+f.r*Ni(f.e)};f.e+=A.angle({x:f.x,y:f.y},C,this.get(1))}break}r=r+(r-n)/2}else r=z;while(!m&&i++<100);if(i>=100)break;p=p||f,s.push(p),n=_}while(r<1);return s}}class Fi{constructor(e){G(this,"width");G(this,"curvePath");G(this,"beziers");this.width=e.width,this.curvePath=new vi,this.beziers=[],this.computeTrack(e.rawSvg)}extractCommandsFromRawSvg(e){const s=document.createElement("template");s.innerHTML=e;const n=s.content.querySelector("svg");if(!n)throw new Error("No svg element found");const r=n.querySelector("path");if(!r)throw new Error("No path element found");const i=r.getAttribute("d");if(!i)throw new Error("No d attribute found on path");return Oe.makeAbsolute(Oe.parseSVG(i))}computeTrack(e){const s=this.extractCommandsFromRawSvg(e);for(let n=0;n<s.length;n++){const r=s[n];switch(s[n].command){case"lineto":case"closepath":(()=>{const i=new Qe(new $(r.x0,r.y0),new $(r.x,r.y));this.curvePath.add(i);const o={x:(r.x0+r.x)/2,y:(r.y0+r.y)/2},a=new V([{x:r.x0,y:r.y0},o,{x:r.x,y:r.y}]);this.beziers.push(a)})();break;case"curveto":(()=>{const i=new Ze(new $(r.x0,r.y0),new $(r.x1,r.y1),new $(r.x2,r.y2),new $(r.x,r.y));this.curvePath.add(i);const o=new V([{x:r.x0,y:r.y0},{x:r.x1,y:r.y1},{x:r.x2,y:r.y2},{x:r.x,y:r.y}]);this.beziers.push(o)})();break}}}getClosestSection(e){const s=[...this.beziers].sort((n,r)=>{const i=new $().copy(n.project(e)),o=new $().copy(r.project(e));return i.sub(e).length()-o.sub(e).length()});return s.length>0?s[0]:null}getClosestPoint(e){const s=this.getClosestSection(e);return s?new $().copy(s.project({x:e.x,y:e.y})):null}getCorrectedPoint(e){const s=this.getClosestPoint(e);if(s){const n=new $().subVectors(e,s);if(n.length()>this.width/2){const r=n.clone().setLength(this.width/2);return s.clone().add(r)}}}}function Ii(h,e){const s="#9f9f9f",n="#df0000",r="#efefef";h.beginPath(),h.setLineDash([]),h.lineWidth=e.width,h.strokeStyle=s,dt(h,e.beziers);const o=e.beziers.map(f=>f.offset(e.width/2)).flat(),a=e.beziers.map(f=>f.offset(-e.width/2)).flat();h.lineWidth=2,h.strokeStyle=n,h.setLineDash([]),h.beginPath(),dt(h,o),h.beginPath(),dt(h,a),h.lineWidth=2,h.strokeStyle=r,h.setLineDash([10,10]),h.beginPath(),dt(h,o),h.beginPath(),dt(h,a);const u=e.beziers.map(f=>f.offset(0)).flat();h.lineWidth=2,h.strokeStyle=r,h.setLineDash([25,50]),h.beginPath(),dt(h,u)}const We=1e3,Ge=1e3,ce=new Fi({rawSvg:Os,width:50}),It=document.createElement("canvas");It.width=We;It.height=Ge;const ae=It.getContext("2d");document.body.appendChild(It);const Ve=new Li,wt=new Si;wt.position;ce.curvePath.getPoint(0,wt.position);function Be(){Ve.updateInputVector(),wt.update(Ve.inputVector);const h=ce.getCorrectedPoint(wt.position);h&&wt.position.copy(h),ae.clearRect(0,0,We,Ge),Ii(ae,ce),ki(ae,wt),requestAnimationFrame(Be)}Be();
